package dempred.datastructure;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

public class DatasetWriter {

	// comment: #c
	// group: #g
	// value: #v
	// predictedGroup: #G
	// predictedValue: #V
	// weight: #w
	// features #f where d is the delimiter
	public static void writeToLineSeperated(Dataset<Datapoint> dataset, File file, String pattern) throws IOException {
		BufferedWriter out = new BufferedWriter(new FileWriter(file, false));
		String output;
		for (Datapoint datapoint : dataset.getDatapoints()) {
			output = pattern.replaceAll("#c", datapoint.getComment());
			
			if (datapoint.getPredictedGroup() != null)
				output = output.replaceAll("#G", datapoint.getPredictedGroup().toString());
			else
				output = output.replaceAll("#G", "");
			
			if (datapoint.getGroup() != null)
				output = output.replaceAll("#g", datapoint.getGroup().toString());
			else
				output = output.replaceAll("#g", "");
			
			if (datapoint.getFeatureVector() != null)
				output = output.replaceAll("#f", datapoint.getFeatureVector().toString(",", "#"));
			else
				output = output.replaceAll("#f", "");
			
			output = output.replaceAll("#v", Double.toString(datapoint.getValue()));
			output = output.replaceAll("#V", Double.toString(datapoint.getPredictedValue()));
			output = output.replaceAll("#w", Double.toString(datapoint.getWeight()));
			out.write(output);
			out.newLine();
		}
		out.flush();
		out.close();
	}

}
