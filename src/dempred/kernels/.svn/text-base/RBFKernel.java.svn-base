package dempred.kernels;

import java.io.Serializable;

import dempred.fmath.FVector;


public class RBFKernel implements KernelInterface, Serializable {
	private static final long serialVersionUID = 4384837381056056453L;
	private double sigma;

	public RBFKernel(double sigma) {
		setSigma(sigma);
	}

	@Override
	public double evaluate(FVector a, FVector b) {
		return Math.exp((-(a.clone().subVector(b)).norm(2)) / (2 * Math.pow(sigma, 2)));
		//same as
		//return Math.exp(-gamma*(a.clone().subVector(b)).norm(2));
	}

	public final double getSigma() {
		return sigma;
	}

	public final void setSigma(double sigma) {
		if (sigma <= 0)
			throw new IllegalArgumentException("Sigma must not be smaller than 0");
		this.sigma = sigma;
	}

}
